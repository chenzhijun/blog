---
layout:     post
title:      "正则表达式"
subtitle:   "个人笔记"
date:       2016-11-26 02:08:00
author:     "chenzhijun"
header-img: "img/in-post/regex.png"
catalog: true
tags:
    - 正则表达式
---
## 正则表达式

>我想你应该在查找文件中遇到过：```* .``` 这两个符号吧？当然如果你玩过数据库，你可能还遇到过 ```%``` 这种符号。它们有什么作用了？它们就是我们用该告诉计算机，抽象类似而不具体的一类事物。

>比如: windows 中搜索```*.md```; ```*``` 任意字符串代表你要找 ```.md``` 结尾的所有文件。
 
 一本书里面找 hi，可能遇到 high， history，him。如果找 hi 的话可以用正则：`\bhi\b`。```\b``` 这种叫元字符，代表单词的开始或结束，英语中常用空格和标点符号或者换行来分隔，但是\b不匹配这些单词分隔符中的任何一个，它只***匹配一个位置***。如果 hi 后面还可能跟着一个 Lucy呢？可以用正则表达式：```\bhi\b.*Lucy\b```。
 
 
### 元字符
 
```.``` 是另一个元字符，匹配除了换行符以外的任意字符。```*``` 也是元字符，不过它代表的不是字符，不是位置，而是数量。它指定```*```前边的内容可以重复任意次数来使表达式匹配。

```.*``` 连着意味着任意数量的不包含换行符的字符。所以正则：```\bhi\b.*Lucy\b``` 就表示已 hi 开头的后面跟着任意个字符直到 Lucy结尾的字符串

```\d``` 匹配数字。电话号码(010-1234567)可以写成正则： ```0\d\d-\d\d\d\d\d\d\d``` ，这样就可以匹配以0开头，后面是两个数字，然后是一个 ```-``` ，之后是8个数字的表达式了。这样确实能实现的，只是可读性不太方便，所以聪明的人使用另一种方式来实现：```0\d{2}-\d{8}``` ,用大括号加里面的数字来表示重复几次。
还有另外一些元字符：

```\s``` 匹配任意的空白符，包括空格，制表符（tab），换行符，中文全角空格等。

```\w``` 匹配字母或者数字或者下划线或者汉字等。

```\ba\w*\b``` 匹配以字母 a 开头然后是任意个数的字母或数字，最后是单词结束处。

```\b\w{6}\b``` 匹配刚好6个字符

```\d+``` 匹配1个或更多的连续的数字。```*``` 匹配是任意（可能是0次), ```+``` 匹配的是重复1次或者更多次

```\b\w{6}\b``` 匹配刚好6个字符的单词

```^``` 匹配字符串的开始

```$``` 匹配字符串的结束

```^ $``` 和```\b``` 有点类似，都匹配一个位置。如果你要匹配 QQ号码为5到12位数字，可以使用正则: ```^\d{5,12}$```。 这里的{5，12}和之前的{2}有点类似，不过{2}表示只能是2次，不多不少，而{5，12}则是表示不能少于5，不能多于12次，否则都不匹配。
因为使用了```^``` ，```$```所以输入的整个字符串都要用来和```\d{5,12}```来匹配，也就是说，整个输入必须是5到12个数字。

和忽略大小写选项类似，有些正则表达式处理工具还有一个处理多行的选项。如果选中了这个选项，```^ $```的意义就变成了匹配行的开始处和结束处。

### 转义
如果你想查找元素本身那怎么办？
可以用```\. \* \\``` 来进行转义。例如：```google\.com```可以用```baidu.com```，又如```c:\\windows``` 匹配```c:\windows```

### 重复
之前用```*，+，{2}，{2，5}```来表示了来匹配重复。统一说明一下可能出现的情况：

```*```:0或者更多

```+```:1或者更多

```?```:0或者一次

```{n}```:重复N次

```{n,}```:重复n或者更多次

```{n,m}```:重复n到m次

如例子：```windows\d+``` 匹配 ```windows```后面跟1个或者更多数字;
```^\w+``` 匹配一行的第一个单词（或者整个字符串的第一个单词，具体匹配那个意思得看选项设置）

### 字符类
如果要查找一个英文字母怎么办比如 a,e,i,o,u ？可以使用正则```[aeiou]```来匹配其中任何一个英文原因字母了。```[.?!]```匹配标点符号（.或者?或者!）
我们也可以指定字符范围：像```[0-9]```的含义和```\d```就完全一样，表示一个数字；同样```[a-z0-9A-Z_]```也完全等价于```\w```（只考虑数字和英文的情况下)，表达式```\(?0\d{2}[) -]?\d{8}``` 就匹配几种格式的电话号码，像(010)88886666或者022-22334455，或者02912345678。分析如下：首先是表示转义字符```\(```，它出现0或者1次,(因为后面接?)，然后是一个0，后面再2个数字，```[) -]```表示它```)```或者空格 ,或者 ```-```出现1次或者不出现(因为?的含义)，然后是8个数字。

### 分枝条件
刚才的表达式其实也可以匹配010)12345678或(022-87654321这种“不正确”的格式。要解决这个问题，我们需要用到分枝条件。正则表达式里面分枝的条件有几种规则:如果满足其中一种规则都应该当成匹配，具体方法是用 ```|``` 把不同的规则分隔开，联想到 Java 中的或运算。
如：
```0\d{2}-\d{8}|0\d{3}-\d{7}``` 这个正则匹配的就是010-12345678或者0376-22334455

```\(?0\d{2}\)?[- ]\d{8}|0\d{2}[- ]?\d{8}``` 这个正则匹配3位区号电话号码，区号可以用小括号括起来，也可以不用，又或者区号与本地号可以用-连接或者空格连接。

```\d{5}-\d{4}|\d{5}```，这个正则匹配连字号间隔的9位数字，或者5位数字。这里稍微注意下匹配顺序，如果写成```\d{5}|\d{5}-\d{4}``` 从左到右，如果匹配了第一个，后面的就不会管其它条件了。

### 分组
重复单个字符知道了，如果要重复一个组，比如ip地址，该怎么办了？现在就可以用到```()``` 了。小括号指定子表达式(也叫分组)
```(\d{1,3}\.){3}\d{1,3}```这个就是简单的 IP 地址匹配表达式。不过这个也会匹配999.999.999.888这种不可能存在的地址。所以只能用冗长的分组，选择，字符类来描述一个正确的 IP 地址 ```((2[0-4]\d|25[0-5]|[01]?\d\d?)\.){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)```。

### 反义
有时候需要查找不属于某个能简单定义的字符类的字符。比如想查找除了数字以外，其它任意字符都行的情况，这时用到反义(___刚好全是大写，和小写相反___)

```\W``` 跟```\w``` 刚好相反,匹配任意不是字母，数字，下划线，汉字的字符

```\S``` 匹配任意不是空白符的字符

```\D``` 匹配任意非数字的字符

```\B``` 匹配不是单词开头或结束的位置

```[^X]```  匹配除了X 以外的任意字符

```[^aeiou]``` 匹配除了 aeiou 这几个字母以外的任意字符

eg: 
	```\S+``` 匹配不包含空白符的字符串
	```<a[^>]+>``` , 匹配用尖括号括起来的以 a 开头的字符串


### 其它正则
如后向引用等，还有许多其它正则，就得靠看官自己琢磨了。














